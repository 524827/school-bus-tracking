{"version":3,"sources":["./src/app/pages/login/driver/map/map.component.html","./src/app/pages/login/driver/map/map.component.scss","./src/app/pages/login/driver/map/map.component.ts","./src/app/pages/login/driver/map/map.module.ts","./src/app/services/route.service.ts"],"names":[],"mappings":"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","file":"driver-map-map-module.js","sourcesContent":["export default \"<ion-card-content padding>\\n  <div #mapElement id=\\\"map\\\" class=\\\"map\\\"></div>\\n</ion-card-content>\"","export default \".map {\\n  width: 100%;\\n  height: 500px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL25hbWRldi9EZXNrdG9wL2dpdCAvd2hlcmUgaXMgbXkgYnVzL3NyYy9hcHAvcGFnZXMvbG9naW4vZHJpdmVyL21hcC9tYXAuY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3BhZ2VzL2xvZ2luL2RyaXZlci9tYXAvbWFwLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtFQUNBLGFBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2xvZ2luL2RyaXZlci9tYXAvbWFwLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1hcCB7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDUwMHB4O1xufSIsIi5tYXAge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiA1MDBweDtcbn0iXX0= */\"","import { Component, OnInit, AfterViewInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { DriverService } from '../../../../services/driver.service';\nimport { RouteService } from '../../../../services/route.service';\nimport { CurrentData, CurrentLocation } from 'src/app/model/curLocation';\n\ndeclare const google: any;\n@Component({\n  selector: 'app-map',\n  templateUrl: './map.component.html',\n  styleUrls: ['./map.component.scss'],\n})\nexport class MapComponent implements OnInit {\n  map: any;\n  @ViewChild('mapElement', {static: true}) mapElement;\n  public curLocation: CurrentLocation;\n  public address: CurrentData;\n  public marker: any;\n  public coordinates: CurrentLocation;\n  driverId;\n  vehicleId;\n  wayPoints = [];\n  constructor(\n    private location: DriverService,\n    private driverService: DriverService,\n    private routeService: RouteService,\n    private route: ActivatedRoute\n  ) {\n    this.route.params.subscribe(data => {\n      this.driverId = data.driverId;\n      console.log('Driver Id : ', this.driverId);\n    });\n  }\n\n  ngOnInit() {\n    console.log(this.driverId);\n    this.getRouteData();\n  }\n\n  // Move bus icon over map.\n  private moveBus(place: any): void {\n    console.log('plcae : ', place);\n    // set cuttent latitude and longitude to marker\n    this.marker.setPosition(new google.maps.LatLng(place.latitude, place.longitude));\n    //   this.map.panTo(new google.maps.LatLng({ lat: place.latitude, lng: place.longitude }));\n  }\n\n  async getRouteData() {\n    const driverData = await this.routeService.getRouteAllDetails(this.driverId);\n    driverData.subscribe(response => {\n      this.initializeRoutesOnMap(response['data']);\n    });\n  }\n\n  initializeRoutesOnMap(serverRouteData) {\n    console.log('Working....');\n    const directionsService = new google.maps.DirectionsService();\n    const directionsDisplay = new google.maps.DirectionsRenderer();\n    this.map = new google.maps.Map(document.getElementById('map'), {\n      zoom: 6,\n      center: new google.maps.LatLng(19.965731, 73.826119),\n    });\n    directionsDisplay.setMap(this.map);\n\n    serverRouteData.forward_routes.map((item, index) => {\n      this.wayPoints.push({\n        location: `${item.location}, Nashik`,\n        stopover: true,\n      });\n    });\n\n    const originPoint = this.wayPoints.shift();\n    const destinationPoint = this.wayPoints.pop();\n    directionsService.route(\n      {\n        origin: originPoint.location,\n        destination: destinationPoint.location,\n        waypoints: this.wayPoints,\n        optimizeWaypoints: true,\n        travelMode: 'DRIVING',\n      },\n      (response, status) => {\n        if (status === 'OK') {\n          directionsDisplay.setDirections(response);\n          /*   const route = response.routes[0];\n          const geocoder = new google.maps.Geocoder(); */\n\n          this.marker = new google.maps.Marker({\n            map: this.map,\n            position: { lat: 19.9975, lng: 73.7898 },\n            icon: '../../../../assets/images/bus2.png',\n            animation: google.maps.Animation.DROP,\n          });\n          // Get current latitude and longitude of driver\n          this.location.curLocation.subscribe((res: CurrentData) => {\n            this.address = res;\n            if (this.address) {\n              console.log('Address : ', this.address);\n              this.moveBus(this.address.curLocation); // move bus marker over map\n            }\n          });\n        } else {\n          window.alert('Directions request failed due to ' + status);\n        }\n      }\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\n\nimport { MapComponent } from './map.component';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\n\n@NgModule({\n  declarations: [MapComponent],\n  imports: [\n    CommonModule,\n    IonicModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        component: MapComponent,\n      },\n    ]),\n  ],\n})\nexport class MapModule {}\n","import { Injectable } from '@angular/core';\nimport { HttpHeaders, HttpClient } from '@angular/common/http';\nimport { environment } from '../../environments/environment';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class RouteService {\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Get routes details associated with driver\n   * @function getRouteDetails()\n   * @param driverId\n   */\n  getRouteDetails(driverId: string) {\n    const data = { driver_id: driverId };\n    const headers = new HttpHeaders();\n    headers.append('Content-type', 'application/json');\n    return this.http.post(`${environment.driverUrl}/routeDetails`, data, { headers: headers });\n  }\n\n  /**\n   * Get routes details associated with driver\n   * @function getRouteAllDetails()\n   * @param driverId\n   */\n  getRouteAllDetails(driverId: string) {\n    const data = { driver_id: driverId };\n    const headers = new HttpHeaders();\n    headers.append('Content-type', 'application/json');\n    return this.http.post(`${environment.driverUrl}/routeAllDetails`, data, { headers: headers });\n  }\n  /**\n   * This function fetch driver details from giver route.\n   * @param routeId - route id\n   */\n  getRouteDriverId(routeId: string) {\n    const data = { routeId: routeId };\n    console.log(data);\n    const headers = new HttpHeaders();\n    headers.append('Content-type', 'application/json');\n    return this.http.post(environment.parentUrl + '/driverDetails', data, { headers: headers });\n  }\n}\n"],"sourceRoot":"webpack:///"}